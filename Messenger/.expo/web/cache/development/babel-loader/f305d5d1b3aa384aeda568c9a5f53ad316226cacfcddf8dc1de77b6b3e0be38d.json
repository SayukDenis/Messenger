{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport Dialogue from \"../../Models/Chats/Dialogue\";\nimport { EMessageType } from \"../../Models/EMessageType\";\nimport Message from \"../../Models/Message\";\nimport User from \"../../Models/User\";\nimport { dataSource } from \"../../local/database\";\nimport { readChats } from \"./chatOperations\";\nimport { readMessages } from \"./messageOperations\";\nimport { saveSelfProfile } from \"./selfProfileOperations\";\nimport { readUsers } from \"./usersOperations\";\nvar manager = dataSource.manager;\nexport function dialogueOperations() {\n  return _dialogueOperations.apply(this, arguments);\n}\nfunction _dialogueOperations() {\n  _dialogueOperations = _asyncToGenerator(function* () {\n    console.log('\\n\\tDialogues start\\n');\n    if (!dataSource.isInitialized) yield dataSource.initialize();\n    var selfProfile = yield saveSelfProfile();\n    var user1 = new User('User1', 'nickname1');\n    user1.numberPhone = '123-456-7890';\n    user1.description = 'This is User1';\n    user1.linkToPhoto = 'https://example.com/user1photo.jpg';\n    var user2 = new User('User2', 'nickname2');\n    user2.numberPhone = '987-654-3210';\n    user2.description = 'This is User2';\n    user2.linkToPhoto = undefined;\n    var user3 = new User('User3', 'nickname3');\n    user3.numberPhone = '555-9999';\n    user3.description = undefined;\n    user3.linkToPhoto = undefined;\n    yield manager.save([user1, user2, user3]);\n    console.log('Users have been saved');\n    var dialogue1 = new Dialogue();\n    dialogue1.linkToPhoto = 'someLink';\n    dialogue1.lastWatchedMessage = [{\n      userId: user1.userId,\n      messageId: undefined\n    }];\n    dialogue1.auditLog = [{\n      sendTime: new Date(),\n      message: 'log1'\n    }, {\n      sendTime: new Date(),\n      message: 'log2'\n    }];\n    dialogue1.users = [selfProfile, user1];\n    yield manager.save(dialogue1);\n    console.log('Dialogue1 has been saved');\n    var dialogue2 = new Dialogue();\n    dialogue2.linkToPhoto = 'someLink';\n    dialogue2.lastWatchedMessage = [{\n      userId: user2.userId,\n      messageId: undefined\n    }];\n    dialogue2.auditLog = [{\n      sendTime: new Date(),\n      message: 'log1'\n    }];\n    dialogue2.users = [selfProfile, user2];\n    yield manager.save(dialogue2);\n    console.log('Dialogue2 has been saved');\n    var dialogue3 = new Dialogue();\n    dialogue3.linkToPhoto = 'someLink';\n    dialogue3.lastWatchedMessage = [{\n      userId: user3.userId,\n      messageId: undefined\n    }];\n    dialogue3.auditLog = [];\n    dialogue3.users = [selfProfile, user3];\n    yield manager.save(dialogue3);\n    console.log('Dialogue3 has been saved');\n    yield readUsers();\n    yield readChats();\n    var message1 = new Message(user1, 'content1', EMessageType.text);\n    message1.numberInChat = 1;\n    var message2 = new Message(user1, 'content2', EMessageType.img);\n    message2.numberInChat = 2;\n    var message3 = new Message(selfProfile, 'content3', EMessageType.text);\n    message3.numberInChat = 3;\n    var message4 = new Message(user2, 'content4', EMessageType.text);\n    message4.numberInChat = 1;\n    var message5 = new Message(selfProfile, 'content5', EMessageType.img);\n    message5.numberInChat = 2;\n    var message6 = new Message(selfProfile, 'content6', EMessageType.text);\n    message6.numberInChat = 3;\n    var message7 = new Message(selfProfile, 'content7', EMessageType.text);\n    message7.numberInChat = 1;\n    var message8 = new Message(selfProfile, 'content8', EMessageType.img);\n    message8.numberInChat = 2;\n    var message9 = new Message(selfProfile, 'content9', EMessageType.text);\n    message9.numberInChat = 3;\n    dialogue1.messages = [message1, message2, message3];\n    dialogue2.messages = [message4, message5, message6];\n    dialogue3.messages = [message7, message8, message9];\n    yield manager.save([dialogue1, dialogue2, dialogue3]);\n    console.log('Dialogues have been updated');\n    yield readDialogues();\n    yield readUsers();\n    yield readMessages();\n    yield manager.remove([dialogue1, dialogue2, dialogue3]);\n    console.log('Dialogues have been deleted');\n    yield readDialogues();\n    yield readMessages();\n    yield readUsers();\n  });\n  return _dialogueOperations.apply(this, arguments);\n}\nexport function readDialogues() {\n  return _readDialogues.apply(this, arguments);\n}\nfunction _readDialogues() {\n  _readDialogues = _asyncToGenerator(function* () {\n    var savedDialogues = yield manager.find(Dialogue);\n    console.log(`Dialogues quantity: ${savedDialogues.length}`);\n    for (var dialogue of savedDialogues) {\n      console.log(dialogue);\n    }\n  });\n  return _readDialogues.apply(this, arguments);\n}","map":{"version":3,"names":["Dialogue","EMessageType","Message","User","dataSource","readChats","readMessages","saveSelfProfile","readUsers","manager","dialogueOperations","_dialogueOperations","apply","arguments","_asyncToGenerator","console","log","isInitialized","initialize","selfProfile","user1","numberPhone","description","linkToPhoto","user2","undefined","user3","save","dialogue1","lastWatchedMessage","userId","messageId","auditLog","sendTime","Date","message","users","dialogue2","dialogue3","message1","text","numberInChat","message2","img","message3","message4","message5","message6","message7","message8","message9","messages","readDialogues","remove","_readDialogues","savedDialogues","find","length","dialogue"],"sources":["C:/Users/T480/source/repos/Messenger/Messenger/dao/test/manualTest/dialogueOperations.ts"],"sourcesContent":["import Dialogue from \"../../Models/Chats/Dialogue\";\r\nimport { EMessageType } from \"../../Models/EMessageType\";\r\nimport Message from \"../../Models/Message\";\r\nimport User from \"../../Models/User\";\r\nimport { dataSource } from \"../../local/database\";\r\nimport { readChats } from \"./chatOperations\";\r\nimport { readMessages } from \"./messageOperations\";\r\nimport { saveSelfProfile } from \"./selfProfileOperations\";\r\nimport { readUsers } from \"./usersOperations\";\r\n\r\nconst manager = dataSource.manager;\r\n\r\nexport async function dialogueOperations() {\r\n\r\n    console.log('\\n\\tDialogues start\\n');\r\n\r\n    if (!dataSource.isInitialized) await dataSource.initialize();\r\n\r\n    const selfProfile = await saveSelfProfile();\r\n\r\n    //Save Users\r\n    const user1 = new User('User1', 'nickname1');\r\n    user1.numberPhone = '123-456-7890';\r\n    user1.description = 'This is User1';\r\n    user1.linkToPhoto = 'https://example.com/user1photo.jpg';\r\n\r\n    const user2 = new User('User2', 'nickname2');\r\n    user2.numberPhone = '987-654-3210';\r\n    user2.description = 'This is User2';\r\n    user2.linkToPhoto = undefined;\r\n\r\n    const user3 = new User('User3', 'nickname3');\r\n    user3.numberPhone = '555-9999';\r\n    user3.description = undefined;\r\n    user3.linkToPhoto = undefined;\r\n    await manager.save([user1, user2, user3]);\r\n    console.log('Users have been saved');\r\n\r\n    //Save Dialogues\r\n    const dialogue1 = new Dialogue();\r\n    dialogue1.linkToPhoto = 'someLink';\r\n    dialogue1.lastWatchedMessage = [{ userId: user1.userId, messageId: undefined }];\r\n    dialogue1.auditLog = [{ sendTime: new Date(), message: 'log1' }, { sendTime: new Date(), message: 'log2' }];\r\n    dialogue1.users = [selfProfile, user1];\r\n    await manager.save(dialogue1);\r\n    console.log('Dialogue1 has been saved');\r\n\r\n    const dialogue2 = new Dialogue();\r\n    dialogue2.linkToPhoto = 'someLink';\r\n    dialogue2.lastWatchedMessage = [{ userId: user2.userId, messageId: undefined }];\r\n    dialogue2.auditLog = [{ sendTime: new Date(), message: 'log1' }];\r\n    dialogue2.users = [selfProfile, user2];\r\n    await manager.save(dialogue2);\r\n    console.log('Dialogue2 has been saved');\r\n\r\n    const dialogue3 = new Dialogue();\r\n    dialogue3.linkToPhoto = 'someLink';\r\n    dialogue3.lastWatchedMessage = [{ userId: user3.userId, messageId: undefined }];\r\n    dialogue3.auditLog = [];\r\n    dialogue3.users = [selfProfile, user3];\r\n    await manager.save(dialogue3);\r\n    console.log('Dialogue3 has been saved');\r\n\r\n    //Read \r\n    await readUsers();\r\n    await readChats();\r\n\r\n    //Update\r\n    let message1 = new Message(user1, 'content1', EMessageType.text);\r\n    message1.numberInChat = 1;\r\n    let message2 = new Message(user1, 'content2', EMessageType.img);\r\n    message2.numberInChat = 2;\r\n    let message3 = new Message(selfProfile, 'content3', EMessageType.text);\r\n    message3.numberInChat = 3;\r\n    let message4 = new Message(user2, 'content4', EMessageType.text);\r\n    message4.numberInChat = 1;\r\n    let message5 = new Message(selfProfile, 'content5', EMessageType.img);\r\n    message5.numberInChat = 2;\r\n    let message6 = new Message(selfProfile, 'content6', EMessageType.text);\r\n    message6.numberInChat = 3;\r\n    let message7 = new Message(selfProfile, 'content7', EMessageType.text);\r\n    message7.numberInChat = 1;\r\n    let message8 = new Message(selfProfile, 'content8', EMessageType.img);\r\n    message8.numberInChat = 2;\r\n    let message9 = new Message(selfProfile, 'content9', EMessageType.text);\r\n    message9.numberInChat = 3;\r\n\r\n    dialogue1.messages = [message1, message2, message3];\r\n    dialogue2.messages = [message4, message5, message6];\r\n    dialogue3.messages = [message7, message8, message9];\r\n    await manager.save([dialogue1, dialogue2, dialogue3]);\r\n    console.log('Dialogues have been updated');\r\n\r\n    //Read \r\n    await readDialogues();\r\n    await readUsers();\r\n    await readMessages();\r\n\r\n    //Delete\r\n    await manager.remove([dialogue1, dialogue2, dialogue3]);\r\n    console.log('Dialogues have been deleted');\r\n\r\n    //Read \r\n    await readDialogues();\r\n    await readMessages();\r\n    await readUsers();\r\n}\r\n\r\nexport async function readDialogues() {\r\n    const savedDialogues = await manager.find(Dialogue);\r\n    console.log(`Dialogues quantity: ${savedDialogues.length}`);\r\n    for (let dialogue of savedDialogues) {\r\n        console.log(dialogue);\r\n    }\r\n}"],"mappings":";AAAA,OAAOA,QAAQ;AACf,SAASC,YAAY;AACrB,OAAOC,OAAO;AACd,OAAOC,IAAI;AACX,SAASC,UAAU;AACnB,SAASC,SAAS;AAClB,SAASC,YAAY;AACrB,SAASC,eAAe;AACxB,SAASC,SAAS;AAElB,IAAMC,OAAO,GAAGL,UAAU,CAACK,OAAO;AAElC,gBAAsBC,kBAAkBA,CAAA;EAAA,OAAAC,mBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AA8FvC,SAAAF,oBAAA;EAAAA,mBAAA,GAAAG,iBAAA,CA9FM,aAAoC;IAEvCC,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;IAEpC,IAAI,CAACZ,UAAU,CAACa,aAAa,EAAE,MAAMb,UAAU,CAACc,UAAU,CAAC,CAAC;IAE5D,IAAMC,WAAW,SAASZ,eAAe,CAAC,CAAC;IAG3C,IAAMa,KAAK,GAAG,IAAIjB,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC;IAC5CiB,KAAK,CAACC,WAAW,GAAG,cAAc;IAClCD,KAAK,CAACE,WAAW,GAAG,eAAe;IACnCF,KAAK,CAACG,WAAW,GAAG,oCAAoC;IAExD,IAAMC,KAAK,GAAG,IAAIrB,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC;IAC5CqB,KAAK,CAACH,WAAW,GAAG,cAAc;IAClCG,KAAK,CAACF,WAAW,GAAG,eAAe;IACnCE,KAAK,CAACD,WAAW,GAAGE,SAAS;IAE7B,IAAMC,KAAK,GAAG,IAAIvB,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC;IAC5CuB,KAAK,CAACL,WAAW,GAAG,UAAU;IAC9BK,KAAK,CAACJ,WAAW,GAAGG,SAAS;IAC7BC,KAAK,CAACH,WAAW,GAAGE,SAAS;IAC7B,MAAMhB,OAAO,CAACkB,IAAI,CAAC,CAACP,KAAK,EAAEI,KAAK,EAAEE,KAAK,CAAC,CAAC;IACzCX,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;IAGpC,IAAMY,SAAS,GAAG,IAAI5B,QAAQ,CAAC,CAAC;IAChC4B,SAAS,CAACL,WAAW,GAAG,UAAU;IAClCK,SAAS,CAACC,kBAAkB,GAAG,CAAC;MAAEC,MAAM,EAAEV,KAAK,CAACU,MAAM;MAAEC,SAAS,EAAEN;IAAU,CAAC,CAAC;IAC/EG,SAAS,CAACI,QAAQ,GAAG,CAAC;MAAEC,QAAQ,EAAE,IAAIC,IAAI,CAAC,CAAC;MAAEC,OAAO,EAAE;IAAO,CAAC,EAAE;MAAEF,QAAQ,EAAE,IAAIC,IAAI,CAAC,CAAC;MAAEC,OAAO,EAAE;IAAO,CAAC,CAAC;IAC3GP,SAAS,CAACQ,KAAK,GAAG,CAACjB,WAAW,EAAEC,KAAK,CAAC;IACtC,MAAMX,OAAO,CAACkB,IAAI,CAACC,SAAS,CAAC;IAC7Bb,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;IAEvC,IAAMqB,SAAS,GAAG,IAAIrC,QAAQ,CAAC,CAAC;IAChCqC,SAAS,CAACd,WAAW,GAAG,UAAU;IAClCc,SAAS,CAACR,kBAAkB,GAAG,CAAC;MAAEC,MAAM,EAAEN,KAAK,CAACM,MAAM;MAAEC,SAAS,EAAEN;IAAU,CAAC,CAAC;IAC/EY,SAAS,CAACL,QAAQ,GAAG,CAAC;MAAEC,QAAQ,EAAE,IAAIC,IAAI,CAAC,CAAC;MAAEC,OAAO,EAAE;IAAO,CAAC,CAAC;IAChEE,SAAS,CAACD,KAAK,GAAG,CAACjB,WAAW,EAAEK,KAAK,CAAC;IACtC,MAAMf,OAAO,CAACkB,IAAI,CAACU,SAAS,CAAC;IAC7BtB,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;IAEvC,IAAMsB,SAAS,GAAG,IAAItC,QAAQ,CAAC,CAAC;IAChCsC,SAAS,CAACf,WAAW,GAAG,UAAU;IAClCe,SAAS,CAACT,kBAAkB,GAAG,CAAC;MAAEC,MAAM,EAAEJ,KAAK,CAACI,MAAM;MAAEC,SAAS,EAAEN;IAAU,CAAC,CAAC;IAC/Ea,SAAS,CAACN,QAAQ,GAAG,EAAE;IACvBM,SAAS,CAACF,KAAK,GAAG,CAACjB,WAAW,EAAEO,KAAK,CAAC;IACtC,MAAMjB,OAAO,CAACkB,IAAI,CAACW,SAAS,CAAC;IAC7BvB,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;IAGvC,MAAMR,SAAS,CAAC,CAAC;IACjB,MAAMH,SAAS,CAAC,CAAC;IAGjB,IAAIkC,QAAQ,GAAG,IAAIrC,OAAO,CAACkB,KAAK,EAAE,UAAU,EAAEnB,YAAY,CAACuC,IAAI,CAAC;IAChED,QAAQ,CAACE,YAAY,GAAG,CAAC;IACzB,IAAIC,QAAQ,GAAG,IAAIxC,OAAO,CAACkB,KAAK,EAAE,UAAU,EAAEnB,YAAY,CAAC0C,GAAG,CAAC;IAC/DD,QAAQ,CAACD,YAAY,GAAG,CAAC;IACzB,IAAIG,QAAQ,GAAG,IAAI1C,OAAO,CAACiB,WAAW,EAAE,UAAU,EAAElB,YAAY,CAACuC,IAAI,CAAC;IACtEI,QAAQ,CAACH,YAAY,GAAG,CAAC;IACzB,IAAII,QAAQ,GAAG,IAAI3C,OAAO,CAACsB,KAAK,EAAE,UAAU,EAAEvB,YAAY,CAACuC,IAAI,CAAC;IAChEK,QAAQ,CAACJ,YAAY,GAAG,CAAC;IACzB,IAAIK,QAAQ,GAAG,IAAI5C,OAAO,CAACiB,WAAW,EAAE,UAAU,EAAElB,YAAY,CAAC0C,GAAG,CAAC;IACrEG,QAAQ,CAACL,YAAY,GAAG,CAAC;IACzB,IAAIM,QAAQ,GAAG,IAAI7C,OAAO,CAACiB,WAAW,EAAE,UAAU,EAAElB,YAAY,CAACuC,IAAI,CAAC;IACtEO,QAAQ,CAACN,YAAY,GAAG,CAAC;IACzB,IAAIO,QAAQ,GAAG,IAAI9C,OAAO,CAACiB,WAAW,EAAE,UAAU,EAAElB,YAAY,CAACuC,IAAI,CAAC;IACtEQ,QAAQ,CAACP,YAAY,GAAG,CAAC;IACzB,IAAIQ,QAAQ,GAAG,IAAI/C,OAAO,CAACiB,WAAW,EAAE,UAAU,EAAElB,YAAY,CAAC0C,GAAG,CAAC;IACrEM,QAAQ,CAACR,YAAY,GAAG,CAAC;IACzB,IAAIS,QAAQ,GAAG,IAAIhD,OAAO,CAACiB,WAAW,EAAE,UAAU,EAAElB,YAAY,CAACuC,IAAI,CAAC;IACtEU,QAAQ,CAACT,YAAY,GAAG,CAAC;IAEzBb,SAAS,CAACuB,QAAQ,GAAG,CAACZ,QAAQ,EAAEG,QAAQ,EAAEE,QAAQ,CAAC;IACnDP,SAAS,CAACc,QAAQ,GAAG,CAACN,QAAQ,EAAEC,QAAQ,EAAEC,QAAQ,CAAC;IACnDT,SAAS,CAACa,QAAQ,GAAG,CAACH,QAAQ,EAAEC,QAAQ,EAAEC,QAAQ,CAAC;IACnD,MAAMzC,OAAO,CAACkB,IAAI,CAAC,CAACC,SAAS,EAAES,SAAS,EAAEC,SAAS,CAAC,CAAC;IACrDvB,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;IAG1C,MAAMoC,aAAa,CAAC,CAAC;IACrB,MAAM5C,SAAS,CAAC,CAAC;IACjB,MAAMF,YAAY,CAAC,CAAC;IAGpB,MAAMG,OAAO,CAAC4C,MAAM,CAAC,CAACzB,SAAS,EAAES,SAAS,EAAEC,SAAS,CAAC,CAAC;IACvDvB,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;IAG1C,MAAMoC,aAAa,CAAC,CAAC;IACrB,MAAM9C,YAAY,CAAC,CAAC;IACpB,MAAME,SAAS,CAAC,CAAC;EACrB,CAAC;EAAA,OAAAG,mBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAED,gBAAsBuC,aAAaA,CAAA;EAAA,OAAAE,cAAA,CAAA1C,KAAA,OAAAC,SAAA;AAAA;AAMlC,SAAAyC,eAAA;EAAAA,cAAA,GAAAxC,iBAAA,CANM,aAA+B;IAClC,IAAMyC,cAAc,SAAS9C,OAAO,CAAC+C,IAAI,CAACxD,QAAQ,CAAC;IACnDe,OAAO,CAACC,GAAG,CAAE,uBAAsBuC,cAAc,CAACE,MAAO,EAAC,CAAC;IAC3D,KAAK,IAAIC,QAAQ,IAAIH,cAAc,EAAE;MACjCxC,OAAO,CAACC,GAAG,CAAC0C,QAAQ,CAAC;IACzB;EACJ,CAAC;EAAA,OAAAJ,cAAA,CAAA1C,KAAA,OAAAC,SAAA;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}