{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport { useRef, useState, useEffect, memo, useMemo } from 'react';\nimport styles from \"./Styles/DialogueMessages\";\nimport React from 'react';\nimport { screenHeight } from \"../../../ChatList/Constants/ConstantsForChatlist\";\nimport Constants from 'expo-constants';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { connect } from 'react-redux';\nimport MessageItem from \"./MessageItem\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar _Dimensions$get = Dimensions.get('screen'),\n  height = _Dimensions$get.height,\n  width = _Dimensions$get.width;\nvar DialogueMessages = function DialogueMessages(_ref) {\n  var setMessageMenuVisible = _ref.setMessageMenuVisible,\n    messageMenuVisisbleAppearence = _ref.messageMenuVisisbleAppearence,\n    messageID = _ref.messageID,\n    listOfMessages = _ref.listOfMessages,\n    isReply = _ref.isReply,\n    isEdit = _ref.isEdit,\n    author = _ref.author;\n  var scrollViewRef = useRef(null);\n  useEffect(function () {\n    if (scrollViewRef.current) {\n      scrollViewRef.current.scrollToOffset({\n        animated: true,\n        offset: 0\n      });\n    }\n  }, [listOfMessages]);\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    coordsY = _useState2[0],\n    setCoordsY = _useState2[1];\n  var insets = useSafeAreaInsets();\n  var checkForSoftMenuBar = function checkForSoftMenuBar() {\n    if (height - screenHeight - Constants.statusBarHeight > 0) return insets.top;\n    return 0;\n  };\n  var _useState3 = useState(0),\n    _useState4 = _slicedToArray(_useState3, 2),\n    keyboardHeight = _useState4[0],\n    setKeyboardHeight = _useState4[1];\n  useEffect(function () {\n    var keyboardDidShowListener = Keyboard.addListener('keyboardDidShow', function (event) {\n      setKeyboardHeight(event.endCoordinates.height);\n    });\n    var keyboardDidHideListener = Keyboard.addListener('keyboardDidHide', function () {\n      setKeyboardHeight(0);\n    });\n    return function () {\n      keyboardDidShowListener.remove();\n      keyboardDidHideListener.remove();\n    };\n  }, []);\n  var keyExtractor = function keyExtractor(item) {\n    return item.messageId.toString();\n  };\n  var setCoordsYHandler = function setCoordsYHandler(newCoordsY) {\n    setCoordsY(newCoordsY);\n  };\n  var renderItem = function renderItem(_ref2) {\n    var item = _ref2.item;\n    return _jsx(MessageItem, {\n      item: item,\n      listOfMessages: listOfMessages,\n      setMessageMenuVisible: setMessageMenuVisible,\n      scrollViewRef: scrollViewRef,\n      coordsY: coordsY,\n      author: author,\n      messageID: messageID,\n      setCoordsY: setCoordsYHandler\n    });\n  };\n  var memoizedItem = useMemo(function () {\n    return renderItem;\n  }, []);\n  var ListHeaderComponent = function ListHeaderComponent() {\n    return _jsx(View, {\n      style: {\n        height: screenHeight * 0.03 + (isReply || isEdit ? screenHeight * 0.05 : 0)\n      }\n    });\n  };\n  var ListFooterComponent = function ListFooterComponent() {\n    return _jsx(View, {\n      style: {\n        backgroundColor: 'transparent',\n        height: screenHeight * 0.08 + Constants.statusBarHeight\n      }\n    });\n  };\n  return _jsx(View, {\n    style: [styles.mainContainer, {\n      height: screenHeight * 0.94 + (checkForSoftMenuBar() ? insets.top : 0) - keyboardHeight,\n      zIndex: 0\n    }],\n    children: _jsx(FlatList, {\n      ref: scrollViewRef,\n      showsVerticalScrollIndicator: false,\n      style: [styles.dialogueChat, {\n        zIndex: 3\n      }],\n      data: listOfMessages,\n      inverted: true,\n      windowSize: 20,\n      keyExtractor: keyExtractor,\n      renderItem: memoizedItem,\n      ListHeaderComponent: ListHeaderComponent,\n      ListFooterComponent: ListFooterComponent\n    })\n  });\n};\nexport default memo(connect(null)(DialogueMessages));","map":{"version":3,"names":["useRef","useState","useEffect","memo","useMemo","styles","React","screenHeight","Constants","useSafeAreaInsets","connect","MessageItem","jsx","_jsx","_Dimensions$get","Dimensions","get","height","width","DialogueMessages","_ref","setMessageMenuVisible","messageMenuVisisbleAppearence","messageID","listOfMessages","isReply","isEdit","author","scrollViewRef","current","scrollToOffset","animated","offset","_useState","_useState2","_slicedToArray","coordsY","setCoordsY","insets","checkForSoftMenuBar","statusBarHeight","top","_useState3","_useState4","keyboardHeight","setKeyboardHeight","keyboardDidShowListener","Keyboard","addListener","event","endCoordinates","keyboardDidHideListener","remove","keyExtractor","item","messageId","toString","setCoordsYHandler","newCoordsY","renderItem","_ref2","memoizedItem","ListHeaderComponent","View","style","ListFooterComponent","backgroundColor","mainContainer","zIndex","children","FlatList","ref","showsVerticalScrollIndicator","dialogueChat","data","inverted","windowSize"],"sources":["D:/project/1project/Messenger/Messenger/Pages/Chats/Dialogue/components/DialogueMessages.tsx"],"sourcesContent":["import { View, Dimensions, ScrollView, Keyboard, KeyboardEvent, FlatList } from 'react-native';\r\nimport { useRef, useState, useEffect, memo, useCallback, useMemo } from 'react';\r\nimport styles from './Styles/DialogueMessages'\r\nimport React from 'react';\r\nimport { DialogueMessagesProps, messageViewHandleProps } from './interfaces/IDialogueMessages';\r\nimport { screenHeight } from '../../../ChatList/Constants/ConstantsForChatlist';\r\nimport Constants from 'expo-constants';\r\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\r\nimport { connect } from 'react-redux';\r\nimport MessageItem from './MessageItem';\r\n\r\nconst { height, width } = Dimensions.get('screen');\r\n\r\nconst DialogueMessages =({setMessageMenuVisible, messageMenuVisisbleAppearence, messageID, listOfMessages, isReply, isEdit, author }:DialogueMessagesProps) => {\r\n  const scrollViewRef = useRef(null);\r\n  useEffect(() => {\r\n    if (scrollViewRef.current) {\r\n      (scrollViewRef.current as FlatList).scrollToOffset({ animated: true, offset: 0 });\r\n    }\r\n  }, [listOfMessages]);\r\n  \r\n  const [coordsY, setCoordsY]:any = useState([]); \r\n\r\n  const insets = useSafeAreaInsets();\r\n\r\n  const checkForSoftMenuBar = () => {\r\n    if(height-screenHeight-Constants.statusBarHeight > 0)\r\n      return insets.top;\r\n    \r\n    return 0;\r\n  } \r\n\r\n  const [keyboardHeight, setKeyboardHeight] = useState(0);\r\n  useEffect(() => {\r\n    const keyboardDidShowListener = Keyboard.addListener(\r\n      'keyboardDidShow',\r\n      (event: KeyboardEvent) => {\r\n        setKeyboardHeight(event.endCoordinates.height);\r\n      }\r\n    );\r\n\r\n    const keyboardDidHideListener = Keyboard.addListener(\r\n      'keyboardDidHide',\r\n      () => {\r\n        setKeyboardHeight(0);\r\n      }\r\n    );\r\n\r\n    // Clean up the event listeners when the component is unmounted\r\n    return () => {\r\n      keyboardDidShowListener.remove();\r\n      keyboardDidHideListener.remove();\r\n    };\r\n  }, []);\r\n\r\n  const keyExtractor = (item:any) => {\r\n    return item.messageId.toString();\r\n  }\r\n\r\n  const setCoordsYHandler = (newCoordsY:any) => {\r\n    setCoordsY(newCoordsY);\r\n  }\r\n\r\n  const renderItem = ({item}:any) => (\r\n    <MessageItem \r\n      item={item}\r\n      listOfMessages={listOfMessages}\r\n      setMessageMenuVisible={setMessageMenuVisible}\r\n      scrollViewRef={scrollViewRef}\r\n      coordsY={coordsY}\r\n      author={author}\r\n      messageID={messageID}\r\n      setCoordsY={setCoordsYHandler}\r\n    />);\r\n  const memoizedItem = useMemo(() => renderItem, []);\r\n\r\n  const ListHeaderComponent = () => (\r\n    <View style={{ height: screenHeight * 0.03+(isReply||isEdit?screenHeight*0.05:0) }} />\r\n  );\r\n\r\n  const ListFooterComponent = () => (\r\n    <View \r\n      style={{ backgroundColor: 'transparent', height: (screenHeight*0.08+Constants.statusBarHeight) }} \r\n    />\r\n  )\r\n\r\n  return(\r\n    <View style={[styles.mainContainer, { height: screenHeight * 0.94 + (checkForSoftMenuBar()?insets.top:0) - keyboardHeight, zIndex:0 }]}>\r\n      <FlatList\r\n        ref={scrollViewRef}\r\n        showsVerticalScrollIndicator={false}\r\n        style={[styles.dialogueChat, { zIndex: 3 }]}\r\n        data={listOfMessages}\r\n        inverted\r\n        windowSize={20}\r\n        keyExtractor={keyExtractor}\r\n        renderItem={memoizedItem}\r\n        ListHeaderComponent={ListHeaderComponent}//<View style={{ backgroundColor: 'transparent', height: screenHeight * 0.08 + Constants.statusBarHeight }} />\r\n        ListFooterComponent={ListFooterComponent} //<View style={{ height: screenHeight * 0.03 }} />\r\n      />\r\n    </View>\r\n  );\r\n};\r\n\r\nexport default memo(connect(null)(DialogueMessages))"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}