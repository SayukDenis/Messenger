{"version":3,"names":["_extends","Object","assign","bind","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_defineProperty","obj","value","_toPropertyKey","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","TypeError","Number","React","findNodeHandle","Platform","WorkletEventHandler","invariant","adaptViewConfig","RNRenderer","configureLayoutAnimations","enableLayoutAnimations","SharedTransition","LayoutAnimationType","getShadowNodeWrapperFromRef","removeFromPropsRegistry","getReduceMotionFromConfig","maybeBuild","SkipEnteringContext","JSPropsUpdater","has","flattenArray","setAndForwardRef","isFabric","isJest","isWeb","shouldBeUseWeb","InlinePropManager","PropsFilter","startWebLayoutAnimation","tryActivateLayoutTransition","configureWebLayoutAnimations","getReducedMotionFromConfig","IS_WEB","IS_FABRIC","onlyAnimatedStyles","styles","filter","style","viewDescriptors","isSameAnimatedStyle","style1","style2","viewsRef","isSameAnimatedProps","createAnimatedComponent","Component","options","isReactComponent","name","AnimatedComponent","constructor","props","getForwardedRef","forwardedRef","setLocalRef","ref","tag","layout","entering","exiting","sharedTransitionTag","_this$context","LAYOUT","displayName","skipEntering","context","current","_this$props","ENTERING","reduceMotionInExiting","getReduceMotion","_this$props2","EXITING","sharedElementTransition","sharedTransitionStyle","reduceMotionInTransition","registerTransition","_sharedElementTransition","_component","animatedStyle","componentDidMount","_attachNativeEvents","_jsPropsUpdater","addOnJSPropsChangeListener","_attachAnimatedStyles","_InlinePropManager","attachInlineProps","_getViewInfo","_isFirstRender","componentWillUnmount","_this$_sharedElementT","_detachNativeEvents","removeOnJSPropsChangeListener","_detachStyles","detachInlineProps","unregisterTransition","_viewTag","_getEventViewRef","_this$_component","_getScrollableNode","_ref","getScrollableNode","node","viewTag","prop","setNativeProps","registerForEvents","unregisterFromEvents","_styles","remove","_this$props$animatedP","animatedProps","_reattachNativeEvents","prevProps","reattachNeeded","_updateFromNative","_this$_component2","_this$_component2$set","_this$_component3","_getAnimatableRef","_ref2","_viewInfo","viewName","shadowNodeWrapper","viewConfig","component","getAnimatableRef","_hostInstance$viewCon","hostInstance","findHostInstance_DEPRECATED","Error","_nativeTag","uiViewClassName","_this$props$animatedP2","_this$props$animatedP3","prevStyles","prevAnimatedProps","_animatedProps","hasReanimated2Props","hasOneSameStyle","prevStyle","isPresent","some","forEach","add","initial","componentDidUpdate","_prevState","snapshot","getSnapshotBeforeUpdate","getBoundingClientRect","render","_PropsFilter","filterNonAnimatedProps","visibility","platformProps","select","web","default","collapsable","createElement","_setComponentRef","forwardRef"],"sources":["createAnimatedComponent.tsx"],"sourcesContent":["'use strict';\nimport type {\n  Component,\n  ComponentClass,\n  ComponentType,\n  FunctionComponent,\n  MutableRefObject,\n} from 'react';\nimport React from 'react';\nimport { findNodeHandle, Platform } from 'react-native';\nimport WorkletEventHandler from '../reanimated2/WorkletEventHandler';\nimport '../reanimated2/layoutReanimation/animationsManager';\nimport invariant from 'invariant';\nimport { adaptViewConfig } from '../ConfigHelper';\nimport { RNRenderer } from '../reanimated2/platform-specific/RNRenderer';\nimport {\n  configureLayoutAnimations,\n  enableLayoutAnimations,\n} from '../reanimated2/core';\nimport {\n  SharedTransition,\n  LayoutAnimationType,\n} from '../reanimated2/layoutReanimation';\nimport type { StyleProps, ShadowNodeWrapper } from '../reanimated2/commonTypes';\nimport { getShadowNodeWrapperFromRef } from '../reanimated2/fabricUtils';\nimport { removeFromPropsRegistry } from '../reanimated2/PropsRegistry';\nimport { getReduceMotionFromConfig } from '../reanimated2/animation/util';\nimport { maybeBuild } from '../animationBuilder';\nimport { SkipEnteringContext } from '../reanimated2/component/LayoutAnimationConfig';\nimport type { AnimateProps } from '../reanimated2';\nimport JSPropsUpdater from './JSPropsUpdater';\nimport type {\n  AnimatedComponentProps,\n  AnimatedProps,\n  InitialComponentProps,\n  AnimatedComponentRef,\n  IAnimatedComponentInternal,\n  ViewInfo,\n} from './commonTypes';\nimport { has, flattenArray } from './utils';\nimport setAndForwardRef from './setAndForwardRef';\nimport {\n  isFabric,\n  isJest,\n  isWeb,\n  shouldBeUseWeb,\n} from '../reanimated2/PlatformChecker';\nimport { InlinePropManager } from './InlinePropManager';\nimport { PropsFilter } from './PropsFilter';\nimport {\n  startWebLayoutAnimation,\n  tryActivateLayoutTransition,\n  configureWebLayoutAnimations,\n  getReducedMotionFromConfig,\n} from '../reanimated2/layoutReanimation/web';\nimport type { CustomConfig } from '../reanimated2/layoutReanimation/web/config';\nimport type { FlatList, FlatListProps } from 'react-native';\n\nconst IS_WEB = isWeb();\nconst IS_FABRIC = isFabric();\n\nfunction onlyAnimatedStyles(styles: StyleProps[]): StyleProps[] {\n  return styles.filter((style) => style?.viewDescriptors);\n}\n\nfunction isSameAnimatedStyle(\n  style1?: StyleProps,\n  style2?: StyleProps\n): boolean {\n  // We cannot use equality check to compare useAnimatedStyle outputs directly.\n  // Instead, we can compare its viewsRefs.\n  return style1?.viewsRef === style2?.viewsRef;\n}\n\nconst isSameAnimatedProps = isSameAnimatedStyle;\n\ntype Options<P> = {\n  setNativeProps: (ref: AnimatedComponentRef, props: P) => void;\n};\n\n/**\n * Lets you create an Animated version of any React Native component.\n *\n * @param component - The component you want to make animatable.\n * @returns A component that Reanimated is capable of animating.\n * @see https://docs.swmansion.com/react-native-reanimated/docs/core/createAnimatedComponent\n */\n\n/**\n * @deprecated Please use `Animated.FlatList` component instead of calling `Animated.createAnimatedComponent(FlatList)` manually.\n */\n// @ts-ignore This is required to create this overload, since type of createAnimatedComponent is incorrect and doesn't include typeof FlatList\nexport function createAnimatedComponent(\n  component: typeof FlatList<unknown>,\n  options?: Options<any>\n): ComponentClass<AnimateProps<FlatListProps<unknown>>>;\n\nexport function createAnimatedComponent<P extends object>(\n  component: FunctionComponent<P>,\n  options?: Options<P>\n): FunctionComponent<AnimateProps<P>>;\n\nexport function createAnimatedComponent<P extends object>(\n  component: ComponentClass<P>,\n  options?: Options<P>\n): ComponentClass<AnimateProps<P>>;\n\nexport function createAnimatedComponent(\n  Component: ComponentType<InitialComponentProps>,\n  options?: Options<InitialComponentProps>\n): any {\n  invariant(\n    typeof Component !== 'function' ||\n      (Component.prototype && Component.prototype.isReactComponent),\n    `Looks like you're passing a function component \\`${Component.name}\\` to \\`createAnimatedComponent\\` function which supports only class components. Please wrap your function component with \\`React.forwardRef()\\` or use a class component instead.`\n  );\n\n  class AnimatedComponent\n    extends React.Component<AnimatedComponentProps<InitialComponentProps>>\n    implements IAnimatedComponentInternal\n  {\n    _styles: StyleProps[] | null = null;\n    _animatedProps?: Partial<AnimatedComponentProps<AnimatedProps>>;\n    _viewTag = -1;\n    _isFirstRender = true;\n    animatedStyle: { value: StyleProps } = { value: {} };\n    _component: AnimatedComponentRef | HTMLElement | null = null;\n    _sharedElementTransition: SharedTransition | null = null;\n    _jsPropsUpdater = new JSPropsUpdater();\n    _InlinePropManager = new InlinePropManager();\n    _PropsFilter = new PropsFilter();\n    _viewInfo?: ViewInfo;\n    static displayName: string;\n    static contextType = SkipEnteringContext;\n    context!: React.ContextType<typeof SkipEnteringContext>;\n\n    constructor(props: AnimatedComponentProps<InitialComponentProps>) {\n      super(props);\n      if (isJest()) {\n        this.animatedStyle = { value: {} };\n      }\n    }\n\n    componentDidMount() {\n      this._attachNativeEvents();\n      this._jsPropsUpdater.addOnJSPropsChangeListener(this);\n      this._attachAnimatedStyles();\n      this._InlinePropManager.attachInlineProps(this, this._getViewInfo());\n\n      if (IS_WEB) {\n        configureWebLayoutAnimations();\n\n        if (!this.props.entering) {\n          this._isFirstRender = false;\n          return;\n        }\n\n        if (getReducedMotionFromConfig(this.props.entering as CustomConfig)) {\n          this._isFirstRender = false;\n          return;\n        }\n\n        startWebLayoutAnimation(\n          this.props,\n          this._component as HTMLElement,\n          LayoutAnimationType.ENTERING\n        );\n      }\n\n      this._isFirstRender = false;\n    }\n\n    componentWillUnmount() {\n      this._detachNativeEvents();\n      this._jsPropsUpdater.removeOnJSPropsChangeListener(this);\n      this._detachStyles();\n      this._InlinePropManager.detachInlineProps();\n      this._sharedElementTransition?.unregisterTransition(this._viewTag);\n\n      if (\n        IS_WEB &&\n        this.props.exiting &&\n        !getReducedMotionFromConfig(this.props.exiting as CustomConfig)\n      ) {\n        startWebLayoutAnimation(\n          this.props,\n          this._component as HTMLElement,\n          LayoutAnimationType.EXITING\n        );\n      }\n    }\n\n    _getEventViewRef() {\n      // Make sure to get the scrollable node for components that implement\n      // `ScrollResponder.Mixin`.\n      return (this._component as AnimatedComponentRef)?.getScrollableNode\n        ? (this._component as AnimatedComponentRef).getScrollableNode?.()\n        : this._component;\n    }\n\n    _attachNativeEvents() {\n      const node = this._getEventViewRef() as AnimatedComponentRef;\n      let viewTag = null; // We set it only if needed\n\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler\n        ) {\n          if (viewTag === null) {\n            viewTag = findNodeHandle(options?.setNativeProps ? this : node);\n          }\n          prop.current.registerForEvents(viewTag as number, key);\n        }\n      }\n    }\n\n    _detachNativeEvents() {\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler\n        ) {\n          prop.current.unregisterFromEvents();\n        }\n      }\n    }\n\n    _detachStyles() {\n      if (IS_WEB && this._styles !== null) {\n        for (const style of this._styles) {\n          if (style?.viewsRef) {\n            style.viewsRef.remove(this);\n          }\n        }\n      } else if (this._viewTag !== -1 && this._styles !== null) {\n        for (const style of this._styles) {\n          style.viewDescriptors.remove(this._viewTag);\n        }\n        if (this.props.animatedProps?.viewDescriptors) {\n          this.props.animatedProps.viewDescriptors.remove(this._viewTag);\n        }\n        if (IS_FABRIC) {\n          removeFromPropsRegistry(this._viewTag);\n        }\n      }\n    }\n\n    _reattachNativeEvents(\n      prevProps: AnimatedComponentProps<InitialComponentProps>\n    ) {\n      for (const key in prevProps) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler &&\n          prop.current.reattachNeeded\n        ) {\n          prop.current.unregisterFromEvents();\n        }\n      }\n\n      let viewTag = null;\n\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler &&\n          prop.current.reattachNeeded\n        ) {\n          if (viewTag === null) {\n            const node = this._getEventViewRef() as AnimatedComponentRef;\n            viewTag = findNodeHandle(options?.setNativeProps ? this : node);\n          }\n          prop.current.registerForEvents(viewTag as number, key);\n          prop.current.reattachNeeded = false;\n        }\n      }\n    }\n\n    _updateFromNative(props: StyleProps) {\n      if (options?.setNativeProps) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        options.setNativeProps(this._component as AnimatedComponentRef, props);\n      } else {\n        // eslint-disable-next-line no-unused-expressions\n        (this._component as AnimatedComponentRef)?.setNativeProps?.(props);\n      }\n    }\n\n    _getViewInfo(): ViewInfo {\n      if (this._viewInfo !== undefined) {\n        return this._viewInfo;\n      }\n\n      let viewTag: number | HTMLElement | null;\n      let viewName: string | null;\n      let shadowNodeWrapper: ShadowNodeWrapper | null = null;\n      let viewConfig;\n      // Component can specify ref which should be animated when animated version of the component is created.\n      // Otherwise, we animate the component itself.\n      const component = (this._component as AnimatedComponentRef)\n        ?.getAnimatableRef\n        ? (this._component as AnimatedComponentRef).getAnimatableRef?.()\n        : this;\n\n      if (IS_WEB) {\n        // At this point I assume that `_setComponentRef` was already called and `_component` is set.\n        // `this._component` on web represents HTMLElement of our component, that's why we use casting\n        viewTag = this._component as HTMLElement;\n        viewName = null;\n        shadowNodeWrapper = null;\n        viewConfig = null;\n      } else {\n        // hostInstance can be null for a component that doesn't render anything (render function returns null). Example: svg Stop: https://github.com/react-native-svg/react-native-svg/blob/develop/src/elements/Stop.tsx\n        const hostInstance = RNRenderer.findHostInstance_DEPRECATED(component);\n        if (!hostInstance) {\n          throw new Error(\n            '[Reanimated] Cannot find host instance for this component. Maybe it renders nothing?'\n          );\n        }\n        // we can access view tag in the same way it's accessed here https://github.com/facebook/react/blob/e3f4eb7272d4ca0ee49f27577156b57eeb07cf73/packages/react-native-renderer/src/ReactFabric.js#L146\n        viewTag = hostInstance?._nativeTag;\n        /**\n         * RN uses viewConfig for components for storing different properties of the component(example: https://github.com/facebook/react-native/blob/main/packages/react-native/Libraries/Components/ScrollView/ScrollViewNativeComponent.js#L24).\n         * The name we're looking for is in the field named uiViewClassName.\n         */\n        viewName = hostInstance?.viewConfig?.uiViewClassName;\n\n        viewConfig = hostInstance?.viewConfig;\n\n        if (IS_FABRIC) {\n          shadowNodeWrapper = getShadowNodeWrapperFromRef(this);\n        }\n      }\n      this._viewInfo = { viewTag, viewName, shadowNodeWrapper, viewConfig };\n      return this._viewInfo;\n    }\n\n    _attachAnimatedStyles() {\n      const styles = this.props.style\n        ? onlyAnimatedStyles(flattenArray<StyleProps>(this.props.style))\n        : [];\n      const prevStyles = this._styles;\n      this._styles = styles;\n\n      const prevAnimatedProps = this._animatedProps;\n      this._animatedProps = this.props.animatedProps;\n\n      const { viewTag, viewName, shadowNodeWrapper, viewConfig } =\n        this._getViewInfo();\n\n      // update UI props whitelist for this view\n      const hasReanimated2Props =\n        this.props.animatedProps?.viewDescriptors || styles.length;\n      if (hasReanimated2Props && viewConfig) {\n        adaptViewConfig(viewConfig);\n      }\n\n      this._viewTag = viewTag as number;\n\n      // remove old styles\n      if (prevStyles) {\n        // in most of the cases, views have only a single animated style and it remains unchanged\n        const hasOneSameStyle =\n          styles.length === 1 &&\n          prevStyles.length === 1 &&\n          isSameAnimatedStyle(styles[0], prevStyles[0]);\n\n        if (!hasOneSameStyle) {\n          // otherwise, remove each style that is not present in new styles\n          for (const prevStyle of prevStyles) {\n            const isPresent = styles.some((style) =>\n              isSameAnimatedStyle(style, prevStyle)\n            );\n            if (!isPresent) {\n              prevStyle.viewDescriptors.remove(viewTag);\n            }\n          }\n        }\n      }\n\n      styles.forEach((style) => {\n        style.viewDescriptors.add({\n          tag: viewTag,\n          name: viewName,\n          shadowNodeWrapper,\n        });\n        if (isJest()) {\n          /**\n           * We need to connect Jest's TestObject instance whose contains just props object\n           * with the updateProps() function where we update the properties of the component.\n           * We can't update props object directly because TestObject contains a copy of props - look at render function:\n           * const props = this._filterNonAnimatedProps(this.props);\n           */\n          this.animatedStyle.value = {\n            ...this.animatedStyle.value,\n            ...style.initial.value,\n          };\n          style.animatedStyle.current = this.animatedStyle;\n        }\n      });\n\n      // detach old animatedProps\n      if (\n        prevAnimatedProps &&\n        !isSameAnimatedProps(prevAnimatedProps, this.props.animatedProps)\n      ) {\n        prevAnimatedProps.viewDescriptors!.remove(viewTag as number);\n      }\n\n      // attach animatedProps property\n      if (this.props.animatedProps?.viewDescriptors) {\n        this.props.animatedProps.viewDescriptors.add({\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          tag: viewTag as number,\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          name: viewName!,\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          shadowNodeWrapper: shadowNodeWrapper!,\n        });\n      }\n    }\n\n    componentDidUpdate(\n      prevProps: AnimatedComponentProps<InitialComponentProps>,\n      _prevState: Readonly<unknown>,\n      // This type comes straight from React\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      snapshot: DOMRect | null\n    ) {\n      this._reattachNativeEvents(prevProps);\n      this._attachAnimatedStyles();\n      this._InlinePropManager.attachInlineProps(this, this._getViewInfo());\n\n      // Snapshot won't be undefined because it comes from getSnapshotBeforeUpdate method\n      if (\n        IS_WEB &&\n        snapshot !== null &&\n        this.props.layout &&\n        !getReducedMotionFromConfig(this.props.layout as CustomConfig)\n      ) {\n        tryActivateLayoutTransition(\n          this.props,\n          this._component as HTMLElement,\n          snapshot\n        );\n      }\n    }\n\n    _setComponentRef = setAndForwardRef<Component | HTMLElement>({\n      getForwardedRef: () =>\n        this.props.forwardedRef as MutableRefObject<\n          Component<Record<string, unknown>, Record<string, unknown>, unknown>\n        >,\n      setLocalRef: (ref) => {\n        // TODO update config\n\n        const tag = IS_WEB\n          ? (ref as HTMLElement)\n          : findNodeHandle(ref as Component);\n\n        const { layout, entering, exiting, sharedTransitionTag } = this.props;\n        if (\n          (layout || entering || exiting || sharedTransitionTag) &&\n          tag != null\n        ) {\n          if (!shouldBeUseWeb()) {\n            enableLayoutAnimations(true, false);\n          }\n          if (layout) {\n            configureLayoutAnimations(\n              tag,\n              LayoutAnimationType.LAYOUT,\n              maybeBuild(\n                layout,\n                undefined /* We don't have to warn user if style has common properties with animation for LAYOUT */,\n                AnimatedComponent.displayName\n              )\n            );\n          }\n          const skipEntering = this.context?.current;\n          if (entering && !skipEntering) {\n            configureLayoutAnimations(\n              tag,\n              LayoutAnimationType.ENTERING,\n              maybeBuild(\n                entering,\n                this.props?.style,\n                AnimatedComponent.displayName\n              )\n            );\n          }\n          if (exiting) {\n            const reduceMotionInExiting =\n              'getReduceMotion' in exiting &&\n              typeof exiting.getReduceMotion === 'function'\n                ? getReduceMotionFromConfig(exiting.getReduceMotion())\n                : getReduceMotionFromConfig();\n            if (!reduceMotionInExiting) {\n              configureLayoutAnimations(\n                tag,\n                LayoutAnimationType.EXITING,\n                maybeBuild(\n                  exiting,\n                  this.props?.style,\n                  AnimatedComponent.displayName\n                )\n              );\n            }\n          }\n          if (sharedTransitionTag && !IS_WEB) {\n            const sharedElementTransition =\n              this.props.sharedTransitionStyle ?? new SharedTransition();\n            const reduceMotionInTransition = getReduceMotionFromConfig(\n              sharedElementTransition.getReduceMotion()\n            );\n            if (!reduceMotionInTransition) {\n              sharedElementTransition.registerTransition(\n                tag as number,\n                sharedTransitionTag\n              );\n              this._sharedElementTransition = sharedElementTransition;\n            }\n          }\n        }\n\n        if (ref !== this._component) {\n          this._component = ref;\n        }\n      },\n    });\n\n    // This is a component lifecycle method from React, therefore we are not calling it directly.\n    // It is called before the component gets rerendered. This way we can access components' position before it changed\n    // and later on, in componentDidUpdate, calculate translation for layout transition.\n    getSnapshotBeforeUpdate() {\n      if (\n        (this._component as HTMLElement).getBoundingClientRect !== undefined\n      ) {\n        return (this._component as HTMLElement).getBoundingClientRect();\n      }\n\n      return null;\n    }\n\n    render() {\n      const props = this._PropsFilter.filterNonAnimatedProps(this);\n\n      if (isJest()) {\n        props.animatedStyle = this.animatedStyle;\n      }\n\n      // Layout animations on web are set inside `componentDidMount` method, which is called after first render.\n      // Because of that we can encounter a situation in which component is visible for a short amount of time, and later on animation triggers.\n      // I've tested that on various browsers and devices and it did not happen to me. To be sure that it won't happen to someone else,\n      // I've decided to hide component at first render. Its visibility is reset in `componentDidMount`.\n      if (\n        this._isFirstRender &&\n        IS_WEB &&\n        props.entering &&\n        !getReducedMotionFromConfig(props.entering as CustomConfig)\n      ) {\n        props.style = {\n          ...(props.style ?? {}),\n          visibility: 'hidden', // Hide component until `componentDidMount` triggers\n        };\n      }\n\n      const platformProps = Platform.select({\n        web: {},\n        default: { collapsable: false },\n      });\n\n      return (\n        <Component\n          {...props}\n          // Casting is used here, because ref can be null - in that case it cannot be assigned to HTMLElement.\n          // After spending some time trying to figure out what to do with this problem, we decided to leave it this way\n          ref={this._setComponentRef as (ref: Component) => void}\n          {...platformProps}\n        />\n      );\n    }\n  }\n\n  AnimatedComponent.displayName = `AnimatedComponent(${\n    Component.displayName || Component.name || 'Component'\n  })`;\n\n  return React.forwardRef<Component>((props, ref) => {\n    return (\n      <AnimatedComponent\n        {...props}\n        {...(ref === null ? null : { forwardedRef: ref })}\n      />\n    );\n  });\n}\n"],"mappings":"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"}