{"version":3,"names":["Animations","customAnimations","WEB_ANIMATIONS_ID","configureWebLayoutAnimations","document","getElementById","style","createElement","id","onload","sheet","console","error","animationName","insertRule","head","appendChild","insertWebAnimation","keyframe","styleTag","customTransitionId","set","removeWebAnimation","_styleTag$sheet","has","deleteRule","get","delete","timeoutScale","frameDurationMs","minimumFrames","scheduleAnimationCleanup","animationDuration","timeoutValue","Math","max","setTimeout","areDOMRectsEqual","r1","r2","x","y","width","height"],"sources":["domUtils.ts"],"sourcesContent":["'use strict';\n\nimport { Animations, customAnimations } from './config';\nimport type { AnimationNames } from './config';\n\nconst WEB_ANIMATIONS_ID = 'ReanimatedWebAnimationsStyle';\n\n/**\n *  Creates `HTMLStyleElement`, inserts it into DOM and then inserts CSS rules into the stylesheet.\n *  If style element already exists, nothing happens.\n */\nexport function configureWebLayoutAnimations() {\n  if (document.getElementById(WEB_ANIMATIONS_ID) !== null) {\n    return;\n  }\n\n  const style = document.createElement('style');\n  style.id = WEB_ANIMATIONS_ID;\n\n  style.onload = () => {\n    if (!style.sheet) {\n      console.error(\n        '[Reanimated] Failed to create layout animations stylesheet'\n      );\n      return;\n    }\n\n    for (const animationName in Animations) {\n      style.sheet.insertRule(Animations[animationName as AnimationNames].style);\n    }\n  };\n\n  document.head.appendChild(style);\n}\n\nexport function insertWebAnimation(animationName: string, keyframe: string) {\n  const styleTag = document.getElementById(\n    WEB_ANIMATIONS_ID\n  ) as HTMLStyleElement;\n\n  if (!styleTag.sheet) {\n    console.error('[Reanimated] Failed to create layout animations stylesheet');\n    return;\n  }\n\n  const customTransitionId = styleTag.sheet.insertRule(keyframe);\n  customAnimations.set(animationName, customTransitionId);\n}\n\nfunction removeWebAnimation(animationName: string) {\n  if (!customAnimations.has(animationName)) {\n    return;\n  }\n\n  const styleTag = document.getElementById(\n    WEB_ANIMATIONS_ID\n  ) as HTMLStyleElement;\n\n  styleTag.sheet?.deleteRule(customAnimations.get(animationName) as number);\n  customAnimations.delete(animationName);\n}\n\nconst timeoutScale = 1.25; // We use this value to enlarge timeout duration. It can prove useful if animation lags.\nconst frameDurationMs = 16; // Just an approximation.\nconst minimumFrames = 10;\n\nexport function scheduleAnimationCleanup(\n  animationName: string,\n  animationDuration: number\n) {\n  // If duration is very short, we want to keep remove delay to at least 10 frames\n  // In our case it is exactly 160/1099 s, which is approximately 0.15s\n  const timeoutValue = Math.max(\n    animationDuration * timeoutScale * 1000,\n    animationDuration + frameDurationMs * minimumFrames\n  );\n\n  setTimeout(() => removeWebAnimation(animationName), timeoutValue);\n}\n\nexport function areDOMRectsEqual(r1: DOMRect, r2: DOMRect) {\n  // There are 4 more fields, but checking these should suffice\n  return (\n    r1.x === r2.x &&\n    r1.y === r2.y &&\n    r1.width === r2.width &&\n    r1.height === r2.height\n  );\n}\n"],"mappings":"AAAA,YAAY;;AAEZ,SAASA,UAAU,EAAEC,gBAAgB,QAAQ,UAAU;AAGvD,MAAMC,iBAAiB,GAAG,8BAA8B;;AAExD;AACA;AACA;AACA;AACA,OAAO,SAASC,4BAA4BA,CAAA,EAAG;EAC7C,IAAIC,QAAQ,CAACC,cAAc,CAACH,iBAAiB,CAAC,KAAK,IAAI,EAAE;IACvD;EACF;EAEA,MAAMI,KAAK,GAAGF,QAAQ,CAACG,aAAa,CAAC,OAAO,CAAC;EAC7CD,KAAK,CAACE,EAAE,GAAGN,iBAAiB;EAE5BI,KAAK,CAACG,MAAM,GAAG,MAAM;IACnB,IAAI,CAACH,KAAK,CAACI,KAAK,EAAE;MAChBC,OAAO,CAACC,KAAK,CACX,4DAA4D,CAC7D;MACD;IACF;IAEA,KAAK,MAAMC,aAAa,IAAIb,UAAU,EAAE;MACtCM,KAAK,CAACI,KAAK,CAACI,UAAU,CAACd,UAAU,CAACa,aAAa,CAAmB,CAACP,KAAK,CAAC;IAC3E;EACF,CAAC;EAEDF,QAAQ,CAACW,IAAI,CAACC,WAAW,CAACV,KAAK,CAAC;AAClC;AAEA,OAAO,SAASW,kBAAkBA,CAACJ,aAAqB,EAAEK,QAAgB,EAAE;EAC1E,MAAMC,QAAQ,GAAGf,QAAQ,CAACC,cAAc,CACtCH,iBAAiB,CACE;EAErB,IAAI,CAACiB,QAAQ,CAACT,KAAK,EAAE;IACnBC,OAAO,CAACC,KAAK,CAAC,4DAA4D,CAAC;IAC3E;EACF;EAEA,MAAMQ,kBAAkB,GAAGD,QAAQ,CAACT,KAAK,CAACI,UAAU,CAACI,QAAQ,CAAC;EAC9DjB,gBAAgB,CAACoB,GAAG,CAACR,aAAa,EAAEO,kBAAkB,CAAC;AACzD;AAEA,SAASE,kBAAkBA,CAACT,aAAqB,EAAE;EAAA,IAAAU,eAAA;EACjD,IAAI,CAACtB,gBAAgB,CAACuB,GAAG,CAACX,aAAa,CAAC,EAAE;IACxC;EACF;EAEA,MAAMM,QAAQ,GAAGf,QAAQ,CAACC,cAAc,CACtCH,iBAAiB,CACE;EAErB,CAAAqB,eAAA,GAAAJ,QAAQ,CAACT,KAAK,cAAAa,eAAA,uBAAdA,eAAA,CAAgBE,UAAU,CAACxB,gBAAgB,CAACyB,GAAG,CAACb,aAAa,CAAC,CAAW;EACzEZ,gBAAgB,CAAC0B,MAAM,CAACd,aAAa,CAAC;AACxC;AAEA,MAAMe,YAAY,GAAG,IAAI,CAAC,CAAC;AAC3B,MAAMC,eAAe,GAAG,EAAE,CAAC,CAAC;AAC5B,MAAMC,aAAa,GAAG,EAAE;AAExB,OAAO,SAASC,wBAAwBA,CACtClB,aAAqB,EACrBmB,iBAAyB,EACzB;EACA;EACA;EACA,MAAMC,YAAY,GAAGC,IAAI,CAACC,GAAG,CAC3BH,iBAAiB,GAAGJ,YAAY,GAAG,IAAI,EACvCI,iBAAiB,GAAGH,eAAe,GAAGC,aAAa,CACpD;EAEDM,UAAU,CAAC,MAAMd,kBAAkB,CAACT,aAAa,CAAC,EAAEoB,YAAY,CAAC;AACnE;AAEA,OAAO,SAASI,gBAAgBA,CAACC,EAAW,EAAEC,EAAW,EAAE;EACzD;EACA,OACED,EAAE,CAACE,CAAC,KAAKD,EAAE,CAACC,CAAC,IACbF,EAAE,CAACG,CAAC,KAAKF,EAAE,CAACE,CAAC,IACbH,EAAE,CAACI,KAAK,KAAKH,EAAE,CAACG,KAAK,IACrBJ,EAAE,CAACK,MAAM,KAAKJ,EAAE,CAACI,MAAM;AAE3B"}